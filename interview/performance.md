<h1 align="center">优化呈现路径</h1>

`DOM` & `CSSOM` => `render tree` => `layout` => `paint`  
[参考文档](https://developers.google.com/web/fundamentals/performance/critical-rendering-path/?hl=zh-cn)

## 1. DOM的构建过程  
  1. 转化: html原始字节 => 根据制定的文件编码格式例如utf-8，将其转换为相应字符  
  2. 符号化: 浏览器将字符串转换为[W3C HTML5](https://www.w3.org/TR/html5/)标准指定的各种符号比如: 
    `<html></html>`, `<body>`等其他尖括号内的字符串，每个符号都有其特殊含义的一套规则  
  3. 词法分析: 符号被转换为对象，定义他们的属性和规则  
  4. DOM构建: 最后，因为HTML标记定义不同的标签间的相互关系（比如某些标签嵌套在其他标签中），所以创建的对象在树状数据结构中
     相互链接，树状数据结构还捕获原始标记中定义的父子关系，比如HTML对象是body对象的父对象，body是paragraph对象的父对象。    
     
  上述整个流程的最终输出就是文档对象模型，即这个简单的“DOM”，浏览器使用它来完成页面后续处理。整个过程可以通过chrome dev tool
  来进行详细的分析与观察，[文档见](httt://developer.chrome.com/devtools)  

## 2. CSS对象模型的构建
  1. 浏览器在构建我们的简单页面时，在文档的head部分碰上了link标签，引用了外部的CSS文件，浏览器预见到它会需要这个资源来渲染
     页面，因此会立即发出一个资源的请求，返回一个CSS文件内容。  
  2. CSS字节会转换为字符，然后转换为符号和节点，最后链接进树状数据结构，即所谓[CSS对象模型]，缩写为CSSOM  
  3. CSSOM也是采用树状结构，在给页面上的一切对象计算最终的样式集，浏览器会先从应用的该节点最通用规则开始，然后通过应用更具
     体的规则递归细化计算的样式-所谓[向下层叠]。同时还需结合浏览器自带的默认样式，即[用户代理样式]  
  4. 整个CSS处理需要的时间，在DevTools中录制的时间轴，并查找"Recalculate style"事件，与DOM解析不同，timeline并不显示单独的
     "Parse CSS"条目，而是在"Recalculate style"这一事件下统一捕获解析，CSSOM树的构建以及样式规则的递归计算。  

## 3. 渲染树
  1. CSSOM和DOM树融合成一棵渲染树，随后计算出每个可见元素的布局，并输出给绘制过程，在屏幕上渲染像素，优化这里每一步对实现
     最佳的渲染路径都是至关重要的。  
  2. DOM树与CSSOM树融合成渲染树，渲染树只包含页面需要的节点，布局计算每个对象的精确位置及尺寸，最后绘制，输入确定
     的渲染树，在屏幕上渲染像素。  

## 4. 布局layout，也叫重排  
  1. 布局过程输出一个盒模型，它精确捕获每个元素在视口中的准确位置，所有相对度量单位都被换位屏幕上的绝对像素位置，等等。  

> 最后我们知道了哪些节点可见，他们的计算样式以及几何信息，我们终于可以将这些信息传递给最后一个阶段，即把渲染树中的每一个
> 节点转换为屏幕上的实际像素，这一步通常称作绘制 - Paint，或者叫"栅格化".
> 每一步都很耗时，做了大量工作，可以使用chrome DevTools帮助我们深入了解上述阶段。

## 总结: 
  1. 处理HTML标记，构建DOM树  
  2. 处理CSS标记，构建CSSOM树  
  3. 将DOM树和CSSOM树融合成渲染树  
  4. 根据渲染树来布局，计算每个节点的几何信息  
  5. 在屏幕上绘制各个节点  

## 优化关键渲染路径就是尽可能的减少以上五步的总时间。

